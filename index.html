<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artist Guessing Bot</title>
    <style>
        button {
            width: 150px;
            height: 50px;
            margin: 10px;
            font-size: 14px;
        }

        .green {
            background-color: green;
            color: white;
        }

        .orange {
            background-color: orange;
            color: white;
        }

        .red {
            background-color: red;
            color: white;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .button-container {
            display: flex;
            flex-direction: column;
            margin: 10px;
        }

        input {
            margin: 10px;
            padding: 8px;
        }
    </style>
</head>
<body>

    <h1>Artist Guessing Bot</h1>

    <input type="text" id="artistSearch" placeholder="Enter artist name" oninput="searchArtist()">
    <div id="searchResults"></div>

    <div id="buttonsContainer" class="container">
        <!-- Buttons will be dynamically added here -->
    </div>

    <script>
        let artistsData = [];
        let artistInfo = {};
        
        // Load the CSV file and parse it
        function loadCSV() {
            const csvUrl = "https://raw.githubusercontent.com/CATninja58/Soundmapsolver/main/MasterArtistList.csv";  // Raw URL from GitHub
            fetch(csvUrl)
                .then(response => response.text())
                .then(csvText => parseCSV(csvText))
                .catch(error => console.error("Error loading CSV file:", error));
        }

        // Parse CSV and load into artistsData array
        function parseCSV(csvText) {
            const rows = csvText.split("\n");
            rows.shift(); // Remove header row
            artistsData = rows.map(row => {
                const [artist, debut, popularity, members, genre, country, gender] = row.split(",");
                return { artist, debut, popularity, members, genre, country, gender };
            });
        }

        // Search for artists based on input
        function searchArtist() {
            const query = document.getElementById("artistSearch").value.toLowerCase();
            const searchResults = document.getElementById("searchResults");
            searchResults.innerHTML = '';

            if (query) {
                const matches = artistsData.filter(artist => artist.artist.toLowerCase().includes(query));
                matches.forEach(match => {
                    const resultDiv = document.createElement("div");
                    resultDiv.textContent = match.artist;
                    resultDiv.onclick = () => displayArtistInfo(match.artist);
                    searchResults.appendChild(resultDiv);
                });
            }
        }

        // Display the artist's information and generate buttons
        function displayArtistInfo(artistName) {
            const artist = artistsData.find(artist => artist.artist === artistName);
            if (artist) {
                artistInfo = artist;  // Store the artist's data for later use

                const buttonsContainer = document.getElementById("buttonsContainer");
                buttonsContainer.innerHTML = "";  // Clear previous buttons

                const buttonContainer = document.createElement("div");
                buttonContainer.className = "button-container";

                // Create and add buttons
                createButton(buttonContainer, "Debut Year", artist.debut, "debut");
                createButton(buttonContainer, "Popularity", artist.popularity, "popularity");
                createButton(buttonContainer, "Members", artist.members, "members");
                createButton(buttonContainer, "Genre", artist.genre, "genre");
                createButton(buttonContainer, "Country", artist.country, "country");
                createButton(buttonContainer, "Gender", artist.gender, "gender");

                buttonsContainer.appendChild(buttonContainer);
            }
        }

        // Create buttons with dropdown and color change functionality
        function createButton(container, label, value, category) {
            const button = document.createElement("button");
            button.textContent = `${label}: ${value}`;
            button.id = category;
            button.onclick = () => showDropdown(button, category, value);
            container.appendChild(button);
        }

        // Show dropdown for options
        function showDropdown(button, category, value) {
            const dropdown = document.createElement("select");
            const options = ["correct", "later ^", "earlier v", "close ^", "close v"];
            options.forEach(option => {
                const optionElement = document.createElement("option");
                optionElement.value = option;
                optionElement.textContent = option;
                dropdown.appendChild(optionElement);
            });

            dropdown.onchange = () => changeButtonColor(button, dropdown.value);
            button.textContent = `${category.charAt(0).toUpperCase() + category.slice(1)}: ${value} (Choose Option)`;
            button.appendChild(dropdown);
        }

        // Change button color based on selected option
        function changeButtonColor(button, option) {
            if (option === "correct") {
                button.className = "green";
            } else if (option === "close ^" || option === "close v") {
                button.className = "orange";
            } else {
                button.className = "red";
            }
        }

        // Load data when the page is ready
        loadCSV();
    </script>

</body>
</html>
